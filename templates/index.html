{% extends "layout.html" %}

{% block content %}
<style>
    html {
        scroll-behavior: smooth;
    }

    /* éšè—æ»šåŠ¨æ¡ */
    body, html {
        overflow: hidden;
    }

    /* ä½¿ç”¨ -webkit- ä¼ªå…ƒç´ æ¥éšè—æ»šåŠ¨æ¡ */
    ::-webkit-scrollbar {
        display: none;
    }

    /* å‘ä¸‹æ»šåŠ¨æç¤ºçš„æ ·å¼ */
    .scroll-hint {
        position: absolute;
        bottom: 2rem; /* è°ƒæ•´é«˜åº¦ */
        left: 50%;
        transform: translateX(-50%);
        font-size: 1.125rem;
    }

    /* æ¸å˜èƒŒæ™¯è‰² */
    .bg-gradient {
        background: linear-gradient(to bottom, #E9C0BE, #E67B75);
    }

    /* èƒŒæ™¯å›¾æ ·å¼ */
    .bg-image {
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        background-image: url("https://pic1.imgdb.cn/item/67b091e1d0e0a243d4ffaa0d.webp");
    }

    /* æç¤ºæ–‡æœ¬é»˜è®¤éšè— */
    .scroll-hint-text {
        display: none;
    }

    /* ç§»åŠ¨ç«¯èƒŒæ™¯å›¾ä½ç½®è°ƒæ•´ */
    @media (max-width: 768px) {
        .bg-image {
            background-position: 70%;
        }
        .scroll-hint-text {
            display: block;
        }
    }

    .text-indent {
        text-indent: 2em; /* ç¼©è¿›ä¸¤ä¸ªå­—ç¬¦ */
    }

    /* å­é¢‘é“éƒ¨åˆ†å·¦å³æ»‘åŠ¨ */
    .scroll-container {
        display: flex;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        scroll-snap-type: x mandatory;
    }

    .scroll-item {
        flex: 0 0 auto;
        scroll-snap-align: start;
        margin-right: 1rem; /* è°ƒæ•´é—´è· */
    }
</style>

<!-- æ•´ä¸ªé¡µé¢ä½¿ç”¨æ»šåŠ¨å¯¹é½ -->
<div class="snap-y snap-mandatory overflow-y-scroll h-screen" id="main-container">

    <!-- é¦–é¡µå±•ç¤ºéƒ¨åˆ† -->
    <section class="h-screen bg-gradient flex flex-col justify-center items-center text-center text-white snap-start relative bg-image">
        <div class="text-shadow">
            <h1 class="text-6xl font-bold">æ²ƒç›é¢‘é“</h1>
            <p class="text-xl mt-4">ä¸€ä¸ªéå®˜æ–¹çš„<a href="https://space.bilibili.com/53456" target="_blank" class="font-bold"> @Warma </a>åŒäººäº¤æµç¤¾åŒº</p>
        </div>
        <!-- æŒ‰é’®éƒ¨åˆ† -->
        <div class="mt-8 flex space-x-4 text-shadow">
            <a href="https://qm.qq.com/q/aTXFsufyeI" target="_blank" class="bg-[#1C7DF2] hover:bg-[#73A7E6] text-[#DDF1E8] font-bold py-2 px-4 rounded flex items-center">
                <i class="fa fa-qq mr-2"></i>
                åŠ å…¥Qç¾¤
            </a>
            <a href="https://pd.qq.com/g/WarmaFans1026/" target="_blank" class="bg-[#1CF193] hover:bg-[#9BE6C5] text-[#BEE9D6] font-bold py-2 px-4 rounded flex items-center">
                <i class="fa fa-hashtag mr-2"></i>
                åŠ å…¥é¢‘é“
            </a>
        </div>
        <!-- å‘ä¸‹æ»šåŠ¨æç¤º -->
        <div class="scroll-hint text-[#3B1426]">
            <span>å‘ä¸‹æ»šåŠ¨æŸ¥çœ‹æ›´å¤š</span>
        </div>
    </section>

    <!-- æ²ƒç›é¢‘é“ä»‹ç»å’Œå­é¢‘é“éƒ¨åˆ† -->
    <section class="h-screen bg-[#E9BED0] text-white snap-start flex flex-col items-center justify-center px-4">
        <div class="max-w-4xl mx-auto">
            <div class="bg-[#F1DDE6] rounded-lg shadow-lg p-6 mt-8">
                <h3 class="text-2xl font-semibold mb-4 text-[#5E1938]">å…³äºæˆ‘ä»¬</h3>
                <p class="text-lg leading-relaxed text-[#5E1938] text-indent">
                    æ²ƒç›é¢‘é“æ˜¯ç”±æ²ƒç›ç²‰ä¸å…±åŒç»´æŠ¤çš„éå®˜æ–¹ç»¼åˆç¤¾åŒºï¼Œè¿™é‡Œæœ‰è¶…è¿‡<span class="text-[#AC1558] font-bold">20ä¸ªå…´è¶£å­é¢‘é“</span>ï¼Œèšé›†äº†<span class="text-[#AC1558] font-bold">1.5ä¸‡+</span>å¿—åŒé“åˆçš„ä¼™ä¼´ã€‚æˆ‘ä»¬è‡´åŠ›äºæ‰“é€ ä¸€ä¸ªæ¸©æš–ã€åŒ…å®¹çš„äº¤æµç©ºé—´ï¼Œåœ¨è¿™é‡Œä½ å¯ä»¥ï¼š
                </p>
                <ul class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-6 text-center text-[#5E1938]">
                    <li class="flex items-center justify-center">â¤åˆ†äº«å¯¹æ²ƒç›çš„å–œçˆ±</li>
                    <li class="flex items-center justify-center">â­äº¤æµå…´è¶£çˆ±å¥½</li>
                    <li class="flex items-center justify-center">ğŸ‰åˆ†äº«æ—¥å¸¸ç”Ÿæ´»</li>
                    <li class="flex items-center justify-center">ğŸ¨å±•ç¤ºåŒäººåˆ›ä½œ</li>
                    <li class="flex items-center justify-center">ğŸ®ç»„é˜Ÿæ¸¸æˆå¼€é»‘</li>
                    <li class="flex items-center justify-center">ğŸ¤ç»“è¯†æœ‰è¶£ä¼™ä¼´</li>
                </ul>
            </div>
        </div>
    </section>

    <!-- è¯¦ç»†ä»‹ç» -->
    <section class="h-screen bg-[#E6B374] text-[#3B2B14] snap-start flex flex-col items-center justify-center px-4">
        <div class="max-w-4xl mx-auto">
            <div class="bg-[#E8D6BE] rounded-lg shadow-lg p-8">
                <h3 class="text-2xl font-semibold mb-6 bg-[#E8D6BE]">ç‰¹è‰²å­é¢‘é“å¯¼èˆª</h3>
                <div class="scroll-container">
                    <div class="scroll-item p-4 bg-[#E8D6BE] rounded-lg hover:bg-[#F0E8DD] transition-colors">
                        <h4 class="font-semibold mb-2 text-xl">â­ å…´è¶£çˆ±å¥½</h4>
                        <ul class="space-y-1 text-sm">
                            <li>ğŸ’­ã€Œè¯­è¨€Cosplayã€</li>
                            <li>â™ ï¸ã€Œæ€ç»´æ¸¸æˆã€</li>
                            <li>â›©ã€Œä¸œæ–¹Projectã€</li>
                            <li>ğŸ²ã€Œå¨±ä¹å®¤ã€</li>
                            <li>ğŸ§ã€ŒéŸ³ä¹äº¤æµã€</li>
                        </ul>
                    </div>
                    
                    <div class="scroll-item p-4 bg-[#E8D6BE] rounded-lg hover:bg-[#F0E8DD] transition-colors">
                        <h4 class="font-semibold mb-2 text-xl">ğŸ® æ¸¸æˆå¤©åœ°</h4>
                        <ul class="space-y-1 text-sm">
                            <li>ğŸµã€ŒéŸ³æ¸¸ã€</li>
                            <li>ğŸ•µï¸â€â™‚ï¸ã€Œç¬¬äº”äººæ ¼ã€</li>
                            <li>ğŸï¸ã€ŒMCæœåŠ¡å™¨ã€</li>
                            <li>â™Ÿï¸ã€Œæ˜æ—¥æ–¹èˆŸã€</li>
                            <li>ğŸ’«ã€Œç±³å“ˆæ¸¸ã€</li>
                        </ul>
                    </div>

                    <div class="scroll-item p-4 bg-[#E8D6BE] rounded-lg hover:bg-[#F0E8DD] transition-colors">
                        <h4 class="font-semibold mb-2 text-xl">ğŸ“š å­¦ä¹ æˆé•¿</h4>
                        <ul class="space-y-1 text-sm">
                            <li>ğŸ“šã€Œå­¦ä¹ äº¤æµã€</li>
                            <li>ğŸ¨ã€Œç”»å’–ã€</li>
                            <li>ğŸ–¥ï¸ã€ŒæŠ€æœ¯äº¤æµã€</li>
                        </ul>
                    </div>
                </div>

                <div class="mt-6 text-center">
                    <p class="text-[#3B2B14] italic">
                        è¿˜æœ‰æ›´å¤šç‰¹è‰²é¢‘é“ç­‰ä½ å‘ç°â€¦â€¦<br>
                    </p>
                    <p class="mt-4 text-[#5E1938] font-medium animate-pulse scroll-hint-text">
                        â† å·¦å³æ»‘åŠ¨æŸ¥çœ‹æ›´å¤šé¢‘é“ â†’
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- å…¶ä»–å†…å®¹éƒ¨åˆ† -->
    <section class="h-screen bg-[#73A7E6] text-center text-[#14243B] snap-start pt-24">
        <h2 class="text-4xl font-bold">å…¶ä»–å†…å®¹</h2>
        <p class="text-xl mt-4">è¿™é‡Œæ˜¯å…¶ä»–ç›¸å…³å†…å®¹ã€‚</p>
    </section>
</div>
<script defer>
// é¢œè‰²è½¬æ¢å·¥å…·å‡½æ•°
const hexToRgb = hex => {
    hex = hex.replace(/^#/, '');
    const bigint = parseInt(hex, 16);
    return {
        r: (bigint >> 16) & 255,
        g: (bigint >> 8) & 255,
        b: bigint & 255
    };
};

const rgbToHsl = (r, g, b) => {
    r /= 255, g /= 255, b /= 255;
    const max = Math.max(r, g, b), min = Math.min(r, g, b);
    let h, s, l = (max + min) / 2;

    if (max !== min) {
        const d = max - min;
        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
        switch (max) {
            case r: h = (g - b) / d + (g < b ? 6 : 0); break;
            case g: h = (b - r) / d + 2; break;
            case b: h = (r - g) / d + 4; break;
        }
        h /= 6;
    }
    return { h: h * 360, s: s * 100, l: l * 100 };
};

const hslToRgb = (h, s, l) => {
    h /= 360, s /= 100, l /= 100;
    let r, g, b;

    if (s === 0) {
        r = g = b = l;
    } else {
        const hue2rgb = (p, q, t) => {
            if (t < 0) t += 1;
            if (t > 1) t -= 1;
            if (t < 1/6) return p + (q - p) * 6 * t;
            if (t < 1/2) return q;
            if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
            return p;
        };
        const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
        const p = 2 * l - q;
        r = hue2rgb(p, q, h + 1/3);
        g = hue2rgb(p, q, h);
        b = hue2rgb(p, q, h - 1/3);
    }
    return {
        r: Math.round(r * 255),
        g: Math.round(g * 255),
        b: Math.round(b * 255)
    };
};

// ç”ŸæˆMaterial Youè°ƒè‰²æ¿
const generatePalettes = baseHex => {
    const { r, g, b } = hexToRgb(baseHex);
    const { h: baseH, s: baseS } = rgbToHsl(r, g, b);
    
    const hues = [
        baseH,
        (baseH + 30) % 360,
        (baseH - 30 + 360) % 360,
        (baseH + 150) % 360,
        (baseH - 150 + 360) % 360
    ];

    return hues.map(hue => 
        Array.from({ length: 13 }, (_, i) => {
            const l = 98 - i * 7.5;
            const s = baseS * (0.3 + 0.7 * (1 - Math.abs(50 - l) / 50); // ä¿®æ­£è¯­æ³•é”™è¯¯
            const { r, g, b } = hslToRgb(hue, Math.min(100, s), l);
            return `#${((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1).toUpperCase()}`;
        })
    );
};

// é¢œè‰²æ˜ å°„å’Œæ›¿æ¢é€»è¾‘
const createColorMap = palettes => {
    const map = new Map();
    palettes[0].forEach((_, i) => 
        palettes.forEach((palette, j) => 
            map.set(palette[i], palettes[3][i])
        )
    );
    return map;
};

const parseColor = value => {
    const rgbMatch = value.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(,\s*([\d.]+))?\)/i);
    if (rgbMatch) return {
        type: 'rgb',
        r: rgbMatch[1],
        g: rgbMatch[2],
        b: rgbMatch[3],
        a: rgbMatch[5] || 1
    };
    
    const hexMatch = value.match(/#([0-9a-f]{3,8})/i);
    if (hexMatch) {
        let hex = hexMatch[1];
        if (hex.length === 3) hex = [...hex].map(c => c + c).join('');
        return {
            type: 'hex',
            value: hex.length > 6 ? hex.slice(0, 6) : hex,
            a: hex.length > 6 ? parseInt(hex.slice(6), 16) / 255 : 1
        };
    }
    return null;
};

const replaceColors = (colorMap, isNight) => {
    const applyColor = (original, alpha) => {
        const target = colorMap.get(original.toUpperCase());
        return target ? (alpha !== 1 ? 
            `rgba(${hexToRgb(target).r}, ${hexToRgb(target).g}, ${hexToRgb(target).b}, ${alpha})` : 
            target) : null;
    };

    document.querySelectorAll('*').forEach(el => {
        // å¤„ç†å†…è”æ ·å¼
        ['color', 'background-color', 'border-color'].forEach(prop => {
            const value = el.style[prop];
            if (!value) return;
            
            const parsed = parseColor(value);
            if (!parsed) return;
            
            const original = parsed.type === 'rgb' ? 
                `#${((1 << 16) + (+parsed.r << 8) + +parsed.g << 8) + +parsed.b).toString(16).slice(1)}` :
                `#${parsed.value}`;
            
            const newColor = applyColor(original, parsed.a);
            if (newColor) el.style[prop] = newColor;
        });

        // å¤„ç†Tailwindç±»å
        Array.from(el.classList).forEach(className => {
            const match = className.match(/(bg|text|border)-\[([^\]]+)\]/);
            if (!match) return;

            const parsed = parseColor(match[2]);
            if (!parsed) return;

            const original = parsed.type === 'rgb' ? 
                `#${((1 << 16) + (+parsed.r << 8) + +parsed.g << 8) + +parsed.b).toString(16).slice(1)}` :
                `#${parsed.value}`;
            
            const newColor = applyColor(original, parsed.a);
            if (newColor) {
                el.classList.replace(
                    className, 
                    `${match[1]}-[${newColor.startsWith('#') ? newColor : newColor.replace(/^rgba?\(/, '').replace(/\)$/, '')}]`
                );
            }
        });
    });
};
//111
// ä¸»é¢˜ç®¡ç†
class ThemeManager {
    constructor(baseColor) {
        this.palettes = generatePalettes(baseColor);
        this.colorMap = createColorMap(this.palettes);
        this.isNight = localStorage.getItem('theme') === 'night';
        
        this.initButton();
        this.applyTheme();
    }

    initButton() {
        this.button = document.createElement('button');
        this.button.textContent = '<i class="qi-105"></i>';
        Object.assign(this.button.style, {
            position: 'fixed',
            bottom: '20px',
            right: '20px',
            padding: '10px 20px',
            borderRadius: '25px',
            transition: 'all 0.3s',
            backgroundColor: '#6750A4',
            color: '#FFFFFF',
            border: 'none',
            zIndex: 1000
        });
        this.button.addEventListener('click', () => this.toggle());
        document.body.appendChild(this.button);
    }

    applyTheme() {
        document.body.style.transition = 'background-color 0.3s, color 0.3s';
        replaceColors(this.colorMap, this.isNight);
        localStorage.setItem('theme', this.isNight ? 'night' : 'day');
        setTimeout(() => document.body.style.transition = '', 300);
    }

    toggle() {
        this.isNight = !this.isNight;
        this.applyTheme();
    }
}

// åˆå§‹åŒ–ï¼ˆå°†#6750A4æ›¿æ¢ä¸ºä½ éœ€è¦çš„æ¯è‰²ï¼‰
new ThemeManager('#6750A4');

// æ·»åŠ å…¨å±€è¿‡æ¸¡æ ·å¼
const style = document.createElement('style');
style.textContent = `* { transition: background-color 0.3s, color 0.3s, border-color 0.3s !important; }`;
document.head.appendChild(style);
    </script>
{% endblock %}